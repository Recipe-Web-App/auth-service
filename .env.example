# OAuth2 Authentication Service Environment Configuration
# Copy this file to .env.local for local development or .env.prod for production deployment

# Environment Configuration (LOCAL OR NONPROD or PROD)
ENVIRONMENT=NONPROD

# JWT Configuration (REQUIRED)
JWT_SECRET=your-jwt-secret-minimum-32-characters-long

# Redis Configuration
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
REDIS_DB=0

# PostgreSQL Database Configuration (OPTIONAL - for user data storage)
# If not configured, user data will only be stored in Redis (not persisted)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=recipe_database
POSTGRES_SCHEMA=recipe_manager
AUTH_DB_USER=                           # REQUIRED if using PostgreSQL
AUTH_DB_PASSWORD=                       # REQUIRED if using PostgreSQL
POSTGRES_SSL_MODE=disable

# MySQL Database Configuration (OPTIONAL - for OAuth2 client credentials storage)
# If not configured, clients will only be stored in Redis (not persisted across restarts)
# Service uses hybrid architecture: MySQL (primary) + Redis (cache) when configured
MYSQL_HOST=localhost                    # Default: localhost
MYSQL_PORT=3306                         # Default: 3306
MYSQL_DB=client_manager                 # Default: client_manager
MYSQL_CLIENT_DB_USER=                   # REQUIRED if using MySQL for client storage
MYSQL_CLIENT_DB_PASSWORD=               # REQUIRED if using MySQL for client storage
MYSQL_MAX_CONN=25                       # Optional: Default 25
MYSQL_MIN_CONN=5                        # Optional: Default 5
MYSQL_MAX_CONN_LIFETIME=1h              # Optional: Default 1h
MYSQL_MAX_CONN_IDLE_TIME=30m            # Optional: Default 30m
MYSQL_HEALTH_CHECK_PERIOD=30s           # Optional: Default 30s
MYSQL_CONNECT_TIMEOUT=10s               # Optional: Default 10s

# Auth Service Client Credentials
AUTH_SERVICE_CLIENT_ID=auth-service-client-id
AUTH_SERVICE_CLIENT_SECRET=auth-service-client-secret

# Server Configuration
SERVER_HOST=0.0.0.0
SERVER_PORT=8080

# JWT Settings
JWT_ISSUER=auth-service
JWT_ACCESS_TOKEN_EXPIRY=15m
JWT_REFRESH_TOKEN_EXPIRY=168h
JWT_ALGORITHM=HS256

# OAuth2 Settings
OAUTH2_PKCE_REQUIRED=true
OAUTH2_DEFAULT_SCOPES=openid,profile
OAUTH2_SUPPORTED_SCOPES=openid,profile,email,read,write,media:read,media:write,user:read,user:write,admin,notification:admin,notification:user
OAUTH2_SUPPORTED_GRANT_TYPES=authorization_code,client_credentials,refresh_token
OAUTH2_SUPPORTED_RESPONSE_TYPES=code

# Security Configuration
SECURITY_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080
SECURITY_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
SECURITY_ALLOWED_HEADERS=*
SECURITY_ALLOW_CREDENTIALS=true

# Logging Configuration
LOGGING_LEVEL=info
LOGGING_FORMAT=text
LOGGING_OUTPUT=stdout

# Enhanced Dual-Output Logging Configuration
# Set ENABLE_DUAL_OUTPUT=true to log to both console and file with different formats
LOGGING_ENABLE_DUAL_OUTPUT=false
LOGGING_CONSOLE_FORMAT=text
LOGGING_FILE_FORMAT=json
# Local development: ./logs/app.log, Container/K8s: /app/logs/app.log
LOGGING_FILE_PATH=./logs/app.log
